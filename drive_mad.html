<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
 // ðŸ”‘ JOUW FIREBASE CONFIG
  const firebaseConfig = {
    apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
    authDomain: "gameparadise-80490.firebaseapp.com",
    projectId: "gameparadise-80490",
    storageBucket: "gameparadise-80490.firebasestorage.app",
    messagingSenderId: "335620903527",
    appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
  };



firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// ========== LOAD BIJ START ==========
auth.onAuthStateChanged(user => {
  if (!user) {
    alert("Niet ingelogd, terug naar homepage");
    window.location.href = "index.html";
    return;
  }

  db.collection("users").doc(user.uid).get()
    .then(doc => {
      if (doc.exists) {
        const level = doc.data().level || 1;
        localStorage.setItem("driveMadLevel", level);
        console.log("Level geladen:", level);
      }
    });
});

// ========== AUTO SAVE ==========
let lastLevel = localStorage.getItem("driveMadLevel") || 1;

setInterval(() => {
  const user = auth.currentUser;
  if (!user) return;

  const currentLevel = localStorage.getItem("driveMadLevel");

  if (currentLevel && currentLevel != lastLevel) {
    lastLevel = currentLevel;

    db.collection("users").doc(user.uid).set({
      level: Number(currentLevel),
      lastSave: new Date()
    });

    console.log("Level opgeslagen:", currentLevel);
  }
}, 3000);
</script>
