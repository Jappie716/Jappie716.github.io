<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Game Paradise â€“ Ultimate Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root {
  --bg: #020617;
  --card-bg: rgba(30, 41, 59, 0.4);
  --primary: #2563eb;
  --accent: #60a5fa;
  --danger: #dc2626;
  --success: #16a34a;
  --warning: #f59e0b;
}

* { box-sizing: border-box; }
body {
  margin: 0; font-family: system-ui, sans-serif;
  background: #020617; color: white;
  display: flex; height: 100vh; overflow: hidden;
}

/* SIDEBAR */
.sidebar {
  width: 260px; min-width: 260px; background: #010409;
  padding: 20px; display: flex; flex-direction: column; border-right: 1px solid #1e293b;
}
.nav-btn {
  background: transparent; padding: 12px; border-radius: 10px;
  margin-bottom: 8px; cursor: pointer; border: none; color: #94a3b8;
  text-align: left; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-size: 15px;
}
.nav-btn:hover { background: #1e293b; color: white; }
.nav-btn.active { background: var(--primary); color: white; font-weight: bold; }

/* MAIN */
.main { flex: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #0f172a, #020617); }
.section { display: none; animation: fadeIn 0.4s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.card {
  background: var(--card-bg); backdrop-filter: blur(10px);
  padding: 25px; border-radius: 15px; border: 1px solid #1e293b;
  margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}

/* CHART */
.chart-container {
  height: 180px; display: flex; align-items: flex-end; gap: 12px;
  padding: 20px 0 40px 0; position: relative;
}
.bar {
  flex: 1; background: linear-gradient(to top, var(--primary), var(--accent));
  border-radius: 4px 4px 0 0; position: relative; min-height: 4px;
}
.bar::after {
  content: attr(data-time); position: absolute; bottom: -25px;
  left: 50%; transform: translateX(-50%); font-size: 10px; color: #64748b;
}

/* EDITOR PREVIEW */
.editor-layout { display: grid; grid-template-columns: 1fr 320px; gap: 30px; }
.preview-pane {
  display: flex; flex-direction: column; align-items: center;
  border-left: 1px solid #1e293b; padding-left: 30px;
}
.game-preview-card {
  width: 200px; background: #020617; border-radius: 12px;
  overflow: hidden; border: 1px solid #334155;
}
.game-preview-card img { width: 100%; height: 120px; object-fit: cover; background: #0f172a; }
.game-preview-card h4 { margin: 0; padding: 12px; text-align: center; font-size: 14px; }

/* TABLE */
table { width: 100%; border-collapse: collapse; }
th { text-align: left; color: #64748b; padding: 12px; border-bottom: 2px solid #1e293b; }
td { padding: 12px; border-bottom: 1px solid #1e293b; vertical-align: middle; }
.thumb { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; }

/* INPUTS */
label { display: block; margin-bottom: 5px; font-size: 13px; color: #94a3b8; }
input, select {
  width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 10px;
  border: 1px solid #334155; background: #0f172a; color: white; outline: none;
}
input:focus { border-color: var(--primary); }
.btn { padding: 12px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
.success { background: var(--success); color: white; width: 100%; }
.danger { background: var(--danger); color: white; }
.warning { background: var(--warning); color: white; }
</style>
</head>
<body>

<div class="sidebar">
  <div class="logo">ğŸ› ï¸ Admin Panel</div>
  <button class="nav-btn active" id="tab-dashboard" onclick="showTab('dashboard')">ğŸ“Š Dashboard</button>
  <button class="nav-btn" id="tab-editor" onclick="showTab('editor')">âœï¸ Game Editor</button>
  <button class="nav-btn" id="tab-games" onclick="showTab('games')">ğŸ® Game Lijst</button>
  <button class="nav-btn" id="tab-categories" onclick="showTab('categories')">ğŸ“‚ CategorieÃ«n</button>
  
  <div style="margin-top: auto;">
    <button class="btn" style="width:100%; background:#1e293b; color:white; margin-bottom:10px" onclick="location.href='index.html'">ğŸ  Bekijk Site</button>
    <button class="btn danger" style="width:100%" onclick="logout()">ğŸšª Log uit</button>
  </div>
</div>

<div class="main">
  <div id="dashboardSection" class="section" style="display:block">
    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 id="statGames" style="color:var(--accent); font-size:32px; margin:0">0</h2>
        <p style="color:#94a3b8; margin:5px 0 0">Games online</p>
      </div>
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 style="color:var(--accent); font-size:32px; margin:0">124</h2>
        <p style="color:#94a3b8; margin:5px 0 0">Gebruikers Vandaag</p>
      </div>
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 id="statCategories" style="color:var(--accent); font-size:32px; margin:0">0</h2>
        <p style="color:#94a3b8; margin:5px 0 0">CategorieÃ«n</p>
      </div>
    </div>

    <div class="card">
      <h3>ğŸ“ˆ Homepage Activiteit (24u)</h3>
      <div class="chart-container" id="activityChart"></div>
    </div>
  </div>

  <div id="editorSection" class="section">
    <div class="card">
      <div class="editor-layout">
        <div class="form-side">
          <h3 id="editorTitle">Nieuwe Game Toevoegen</h3>
          <label>Game ID (bijv: drive-mad)</label>
          <input id="editId" placeholder="uniek-id">
          <label>Titel</label>
          <input id="editTitle" placeholder="Naam van de game" oninput="updatePreview()">
          <label>Afbeelding URL</label>
          <input id="editImg" placeholder="https://link-naar-foto.jpg" oninput="updatePreview()">
          <label>Bestandsnaam (Link)</label>
          <input id="editLink" value="games/" oninput="updatePreview()">
          <label>Categorie</label>
          <select id="editCat"></select>
          <button class="btn success" onclick="saveGame()">ğŸš€ Publiceren / Opslaan</button>
        </div>
        <div class="preview-pane">
          <p style="color:#64748b; font-size:11px; margin-bottom:10px">PREVIEW OP SITE</p>
          <div class="game-preview-card">
            <img id="preImg" src="https://via.placeholder.com/200x120?text=Geen+Foto">
            <h4 id="preTitle">Titel</h4>
          </div>
          <button class="btn" style="margin-top:20px; background:#1e293b; color:white" onclick="resetEditor()">ğŸ§¹ Reset Formulier</button>
        </div>
      </div>
    </div>
  </div>

  <div id="gamesSection" class="section">
    <div class="card">
      <h3>Beheer alle Games</h3>
      <table>
        <thead>
          <tr><th>Beeld</th><th>Titel (ID)</th><th>Categorie</th><th>Acties</th></tr>
        </thead>
        <tbody id="gamesList"></tbody>
      </table>
    </div>
  </div>

  <div id="categoriesSection" class="section">
    <div class="card">
      <h3>Nieuwe Categorie</h3>
      <input id="catId" placeholder="ID (bijv: sport)">
      <input id="catName" placeholder="Naam (bijv: Sport Spellen)">
      <button class="btn success" onclick="addCategory()">Toevoegen</button>
    </div>
    <div class="card">
      <h3>Bestaande CategorieÃ«n</h3>
      <div id="categoriesList"></div>
    </div>
  </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490",
  storageBucket: "gameparadise-80490.firebasestorage.app",
  messagingSenderId: "335620903527",
  appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
const ADMIN_EMAIL = "someoeneheilig@gmail.com";

function showTab(id) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id + 'Section').style.display = 'block';
  document.getElementById('tab-' + id).classList.add('active');
}

function updatePreview() {
  document.getElementById('preImg').src = document.getElementById('editImg').value || 'https://via.placeholder.com/200x120?text=Geen+Foto';
  document.getElementById('preTitle').textContent = document.getElementById('editTitle').value || "Titel";
}

function resetEditor() {
  document.getElementById('editId').value = "";
  document.getElementById('editId').disabled = false;
  document.getElementById('editTitle').value = "";
  document.getElementById('editImg').value = "";
  document.getElementById('editLink').value = "games/";
  document.getElementById('editorTitle').textContent = "Nieuwe Game Toevoegen";
  updatePreview();
}

// LOGICA
auth.onAuthStateChanged(user => {
  if (user && user.email === ADMIN_EMAIL) init();
  else location.href = "index.html";
});

function init() {
  loadStats();
  loadGames();
  loadCats();
  loadChart();
}

function loadChart() {
  const chart = document.getElementById('activityChart');
  const tijden = ["08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00"];
  chart.innerHTML = "";
  tijden.forEach(t => {
    const val = Math.floor(Math.random() * 90) + 10;
    chart.innerHTML += `<div class="bar" style="height:${val}%" data-time="${t}"></div>`;
  });
}

function loadStats() {
  db.collection("games").get().then(s => document.getElementById('statGames').textContent = s.size);
  db.collection("categories").get().then(s => document.getElementById('statCategories').textContent = s.size);
}

function loadGames() {
  const list = document.getElementById('gamesList');
  list.innerHTML = "";
  db.collection("games").get().then(snap => {
    snap.forEach(doc => {
      const g = doc.data();
      list.innerHTML += `<tr>
        <td><img src="${g.image}" class="thumb"></td>
        <td><b>${g.title}</b><br><small>${doc.id}</small></td>
        <td>${g.category}</td>
        <td>
          <button class="btn warning" style="padding:5px 10px" onclick="editGame('${doc.id}')">âœï¸</button>
          <button class="btn danger" style="padding:5px 10px" onclick="deleteItem('games','${doc.id}')">ğŸ—‘ï¸</button>
        </td>
      </tr>`;
    });
  });
}

function loadCats() {
  const list = document.getElementById('categoriesList');
  const select = document.getElementById('editCat');
  list.innerHTML = ""; select.innerHTML = "";
  db.collection("categories").get().then(snap => {
    snap.forEach(doc => {
      list.innerHTML += `<div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #334155">
        <span>${doc.data().name} (${doc.id})</span>
        <button class="btn danger" style="padding:2px 8px" onclick="deleteItem('categories','${doc.id}')">X</button>
      </div>`;
      select.innerHTML += `<option value="${doc.id}">${doc.data().name}</option>`;
    });
  });
}

function editGame(id) {
  db.collection("games").doc(id).get().then(doc => {
    const g = doc.data();
    document.getElementById('editId').value = id;
    document.getElementById('editId').disabled = true;
    document.getElementById('editTitle').value = g.title;
    document.getElementById('editImg').value = g.image;
    document.getElementById('editLink').value = g.link;
    document.getElementById('editCat').value = g.category;
    document.getElementById('editorTitle').textContent = "Game Bewerken: " + g.title;
    updatePreview();
    showTab('editor');
  });
}

function saveGame() {
  const id = document.getElementById('editId').value;
  if (!id) return alert("ID nodig!");
  const data = {
    title: document.getElementById('editTitle').value,
    image: document.getElementById('editImg').value,
    link: document.getElementById('editLink').value,
    category: document.getElementById('editCat').value
  };
  db.collection("games").doc(id).set(data).then(() => {
    alert("Opgeslagen!");
    resetEditor();
    init();
  });
}

function addCategory() {
  const id = document.getElementById('catId').value;
  db.collection("categories").doc(id).set({ name: document.getElementById('catName').value }).then(() => init());
}

function deleteItem(col, id) {
  if (confirm("Verwijderen?")) db.collection(col).doc(id).delete().then(() => init());
}

function logout() { auth.signOut().then(() => location.href = "index.html"); }
</script>
</body>
</html>
