<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Game Paradise ‚Äì Admin Editor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root {
  --bg: #020617;
  --card-bg: rgba(30, 41, 59, 0.5);
  --primary: #2563eb;
  --accent: #60a5fa;
  --danger: #dc2626;
  --success: #16a34a;
  --warning: #f59e0b;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(180deg, #020617, #0b0f19);
  color: white;
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* SIDEBAR */
.sidebar {
  width: 260px;
  min-width: 260px;
  background: var(--bg);
  padding: 20px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid #1e293b;
}

.logo {
  text-align: center; font-size: 22px; font-weight: bold;
  color: var(--accent); margin-bottom: 30px;
}

.nav-btn {
  background: transparent;
  padding: 12px 15px;
  border-radius: 10px;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all .2s;
  border: none;
  color: #94a3b8;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 15px;
}

.nav-btn:hover { background: #1e293b; color: white; }
.nav-btn.active { background: var(--primary); color: white; font-weight: bold; }

/* MAIN CONTENT */
.main { flex: 1; padding: 30px; overflow-y: auto; background: rgba(15, 23, 42, 0.3); }
.section { display: none; animation: fadeIn 0.3s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.card {
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  padding: 25px;
  border-radius: 15px;
  border: 1px solid #1e293b;
  margin-bottom: 25px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.card h3 { margin-top: 0; margin-bottom: 20px; color: var(--accent); display: flex; align-items: center; gap: 10px; }

/* DASHBOARD STATS */
.stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
.stat-box { 
  background: var(--card-bg); 
  padding: 25px; 
  border-radius: 15px; 
  text-align: center; 
  border: 1px solid #1e293b;
  transition: transform 0.3s;
}
.stat-box:hover { transform: translateY(-5px); border-color: var(--primary); }
.stat-box h2 { font-size: 36px; margin: 0; color: var(--accent); }
.stat-box p { margin: 5px 0 0; color: #94a3b8; font-weight: 500; }

/* FORMS & INPUTS */
.grid-form { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.full-width { grid-column: span 2; }

label { display: block; font-size: 13px; color: #94a3b8; margin-bottom: 8px; font-weight: 500; }

input, select {
  width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #334155;
  background: #0f172a; color: white; outline: none; transition: border-color 0.2s;
}
input:focus { border-color: var(--primary); }
input:disabled { opacity: 0.5; cursor: not-allowed; }

.btn {
  padding: 12px 20px; border-radius: 10px; border: none; cursor: pointer; 
  font-weight: bold; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 8px;
}
.btn:active { transform: scale(0.98); }
.primary { background: var(--primary); color: white; }
.success { background: var(--success); color: white; }
.danger { background: var(--danger); color: white; }
.warning { background: var(--warning); color: white; }

/* DATA TABLE */
.table-container { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; }
th { text-align: left; color: #64748b; padding: 15px 10px; font-size: 14px; border-bottom: 2px solid #1e293b; }
td { padding: 15px 10px; border-bottom: 1px solid #1e293b; font-size: 14px; color: #e2e8f0; }
.thumb { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; background: #1e293b; }

.action-btns { display: flex; gap: 8px; }
.btn-sm { padding: 8px; border-radius: 6px; font-size: 12px; }

</style>
</head>

<body>

<div class="sidebar">
  <div class="logo">üõ†Ô∏è Game Paradise</div>
  <button class="nav-btn active" id="btn-dash" onclick="showTab('dashboard')">üìä Dashboard & Editor</button>
  <button class="nav-btn" id="btn-games" onclick="showTab('games')">üéÆ Alle Games</button>
  <button class="nav-btn" id="btn-cats" onclick="showTab('categories')">üìÇ Categorie√´n</button>
  
  <div style="margin-top: auto; display: flex; flex-direction: column; gap: 10px;">
    <button class="btn" style="background: #1e293b; color: white;" onclick="location.href='index.html'">üè† Naar de Site</button>
    <button class="btn danger" onclick="logout()">üö™ Uitloggen</button>
  </div>
</div>

<div class="main">
  <h2 id="pageTitle" style="margin-top: 0; margin-bottom: 25px;">Dashboard</h2>

  <div id="dashboardSection" class="section" style="display:block">
    <div class="stats">
      <div class="stat-box"> <h2 id="statGames">0</h2> <p>Totaal Games</p> </div>
      <div class="stat-box"> <h2 id="statCategories">0</h2> <p>Categorie√´n</p> </div>
      <div class="stat-box"> <h2>üõ°Ô∏è</h2> <p>Admin Toegang</p> </div>
    </div>

    <div class="card">
      <h3 id="editorHeader">‚ú® Game Toevoegen / Bewerken</h3>
      <div class="grid-form">
        <div>
          <label>Game ID (Bijv: drive-mad)</label>
          <input id="editId" placeholder="uniek-id-zonder-spaties">
        </div>
        <div>
          <label>Naam van de Game</label>
          <input id="editTitle" placeholder="Bijv: Drive Mad Pro">
        </div>
        <div class="full-width">
          <label>Afbeelding URL</label>
          <input id="editImg" placeholder="https://mijn-site.nl/afbeelding.jpg">
        </div>
        <div>
          <label>Locatie / Link (Bestand)</label>
          <input id="editLink" value="games/" placeholder="games/spelnaam.html">
        </div>
        <div>
          <label>Categorie</label>
          <select id="editCat"></select>
        </div>
        <div class="full-width" style="display: flex; gap: 12px; margin-top: 15px;">
          <button class="btn success" style="flex: 2;" onclick="saveGame()">üíæ Wijzigingen Opslaan</button>
          <button class="btn" style="flex: 1; background: #334155; color: white;" onclick="resetEditor()">üßπ Leegmaken</button>
        </div>
      </div>
    </div>
  </div>

  <div id="gamesSection" class="section">
    <div class="card">
      <h3>üìã Lijst met alle Games</h3>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Beeld</th>
              <th>Titel & ID</th>
              <th>Categorie</th>
              <th>Acties</th>
            </tr>
          </thead>
          <tbody id="gamesList"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="categoriesSection" class="section">
    <div class="card">
      <h3>‚ûï Nieuwe Categorie</h3>
      <div class="grid-form">
        <div>
          <label>ID (Kort, bijv: race)</label>
          <input id="catId" placeholder="race">
        </div>
        <div>
          <label>Naam (Zichtbaar op site)</label>
          <input id="catName" placeholder="Race Games">
        </div>
        <div class="full-width">
            <button class="btn success" style="width: 100%;" onclick="addCategory()">Opslaan</button>
        </div>
      </div>
    </div>
    <div class="card">
      <h3>üìÇ Bestaande Categorie√´n</h3>
      <div id="categoriesList"></div>
    </div>
  </div>
</div>

<script>
// -- CONFIGURATIE --
const firebaseConfig = {
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490",
  storageBucket: "gameparadise-80490.firebasestorage.app",
  messagingSenderId: "335620903527",
  appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const ADMIN_EMAIL = "someoeneheilig@gmail.com";

// -- NAVIGATIE --
function showTab(tabId) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  
  document.getElementById(tabId + 'Section').style.display = 'block';
  
  const activeBtn = {
      'dashboard': 'btn-dash',
      'games': 'btn-games',
      'categories': 'btn-cats'
  };
  document.getElementById(activeBtn[tabId]).classList.add('active');
  document.getElementById('pageTitle').textContent = document.getElementById(activeBtn[tabId]).textContent;
}

// -- AUTH CONTROLE --
auth.onAuthStateChanged(user => {
  if (!user || user.email !== ADMIN_EMAIL) {
    location.href = "index.html";
  } else {
    init();
  }
});

function logout() { auth.signOut().then(() => location.href = "index.html"); }

// -- DATA INITIALISATIE --
function init() {
  loadStats();
  loadCategories();
  loadGames();
}

function loadStats() {
  db.collection("games").get().then(s => document.getElementById('statGames').textContent = s.size);
  db.collection("categories").get().then(s => document.getElementById('statCategories').textContent = s.size);
}

function loadCategories() {
  const list = document.getElementById("categoriesList");
  const select = document.getElementById("editCat");
  list.innerHTML = ""; select.innerHTML = "";
  db.collection("categories").get().then(snap => {
    snap.forEach(doc => {
      const d = doc.data();
      list.innerHTML += `
        <div style="display:flex; justify-content:space-between; align-items:center; padding:15px; border-bottom:1px solid #1e293b;">
          <span><b>${d.name}</b> <small style="color:#64748b; margin-left:10px;">ID: ${doc.id}</small></span>
          <button class="btn danger btn-sm" onclick="deleteItem('categories', '${doc.id}')">Verwijderen</button>
        </div>`;
      select.innerHTML += `<option value="${doc.id}">${d.name}</option>`;
    });
  });
}

function loadGames() {
  const list = document.getElementById("gamesList");
  list.innerHTML = "";
  db.collection("games").get().then(snap => {
    snap.forEach(doc => {
      const g = doc.data();
      list.innerHTML += `
        <tr>
          <td><img src="${g.image}" class="thumb" onerror="this.src='https://via.placeholder.com/50x50?text=Error'"></td>
          <td><b>${g.title}</b><br><small style="color:#64748b;">${doc.id}</small></td>
          <td><span style="background:#1e293b; padding:4px 8px; border-radius:5px; font-size:12px;">${g.category}</span></td>
          <td>
            <div class="action-btns">
              <button class="btn warning btn-sm" onclick="editGame('${doc.id}')">‚úèÔ∏è Edit</button>
              <button class="btn danger btn-sm" onclick="deleteItem('games', '${doc.id}')">üóëÔ∏è</button>
            </div>
          </td>
        </tr>`;
    });
  });
}

// -- EDITOR FUNCTIES --
function editGame(id) {
  db.collection("games").doc(id).get().then(doc => {
    if(!doc.exists) return;
    const g = doc.data();
    
    // Vul velden in
    const idInput = document.getElementById('editId');
    idInput.value = id;
    idInput.disabled = true; // ID vastzetten bij bewerken
    
    document.getElementById('editTitle').value = g.title || "";
    document.getElementById('editImg').value = g.image || "";
    document.getElementById('editLink').value = g.link || "games/";
    document.getElementById('editCat').value = g.category || "";
    
    document.getElementById('editorHeader').textContent = "‚úèÔ∏è Game Bewerken: " + g.title;
    showTab('dashboard');
    window.scrollTo({top: 0, behavior: 'smooth'});
  });
}

function saveGame() {
  const idInput = document.getElementById('editId');
  const id = idInput.value.trim();
  
  if(!id) return alert("Je moet een ID invullen!");
  
  const data = {
    title: document.getElementById('editTitle').value,
    image: document.getElementById('editImg').value,
    link: document.getElementById('editLink').value,
    category: document.getElementById('editCat').value
  };

  db.collection("games").doc(id).set(data).then(() => {
    alert("Succesvol opgeslagen!");
    resetEditor();
    init(); // Ververs data
  }).catch(e => alert("Fout: " + e.message));
}

function resetEditor() {
  const idInput = document.getElementById('editId');
  idInput.value = "";
  idInput.disabled = false;
  document.getElementById('editTitle').value = "";
  document.getElementById('editImg').value = "";
  document.getElementById('editLink').value = "games/";
  document.getElementById('editorHeader').textContent = "‚ú® Game Toevoegen / Bewerken";
}

// -- CATEGORIE & VERWIJDEREN --
function addCategory() {
  const id = document.getElementById('catId').value.trim();
  const name = document.getElementById('catName').value.trim();
  if(!id || !name) return alert("Vul beide velden in!");
  
  db.collection("categories").doc(id).set({ name: name }).then(() => {
    document.getElementById('catId').value = "";
    document.getElementById('catName').value = "";
    init();
  });
}

function deleteItem(col, id) {
  if(confirm("Weet je 100% zeker dat je '" + id + "' wilt verwijderen uit " + col + "?")) {
    db.collection(col).doc(id).delete().then(() => {
      init();
    });
  }
}
</script>
</body>
</html>
