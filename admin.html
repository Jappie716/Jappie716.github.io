<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  margin: 0;
  background: #0b0f19;
  color: white;
  font-family: Arial, sans-serif;
  padding: 20px;
}

.panel {
  max-width: 800px;
  margin: auto;
  background: #111827;
  padding: 20px;
  border-radius: 10px;
}

h2 { color: #60a5fa; }

input, select, button {
  width: 100%;
  padding: 8px;
  margin-top: 8px;
  border-radius: 5px;
  border: none;
}

button {
  background: #2563eb;
  color: white;
  cursor: pointer;
}

.list {
  margin-top: 15px;
  background: #1e293b;
  padding: 10px;
  border-radius: 5px;
}
.item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 6px;
}
</style>
</head>
<body>

<div class="panel">
  <h2>Categorie toevoegen</h2>
  <input id="catId" placeholder="Categorie ID (bv no-save)">
  <input id="catName" placeholder="Naam">
  <button onclick="saveCategory()">Opslaan</button>

  <div id="catList" class="list"></div>

  <h2>Game toevoegen</h2>
  <input id="gameId" placeholder="Game ID">
  <input id="gameTitle" placeholder="Titel">
  <input id="gameImage" placeholder="Afbeelding URL">
  <input id="gameLink" placeholder="Link">
  <select id="gameCategory"></select>
  <button onclick="saveGame()">Opslaan</button>

  <div id="gameList" class="list"></div>
</div>

<script>
const ADMIN_EMAIL = "someoeneheilig@gmail.com";

firebase.initializeApp({
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490"
});

const auth = firebase.auth();
const db = firebase.firestore();

const catId = document.getElementById("catId");
const catName = document.getElementById("catName");
const gameId = document.getElementById("gameId");
const gameTitle = document.getElementById("gameTitle");
const gameImage = document.getElementById("gameImage");
const gameLink = document.getElementById("gameLink");
const gameCategory = document.getElementById("gameCategory");

auth.onAuthStateChanged(user => {
  if (!user || user.email !== ADMIN_EMAIL) {
    alert("Geen toegang");
    location.href = "index.html";
  }
});

function saveCategory() {
  db.collection("categories").doc(catId.value).set({
    name: catName.value
  });
  loadCategories();
}

function saveGame() {
  db.collection("games").doc(gameId.value).set({
    title: gameTitle.value,
    image: gameImage.value,
    link: gameLink.value,
    category: gameCategory.value
  });
  loadGames();
}

function loadCategories() {
  const list = document.getElementById("catList");
  list.innerHTML = "";
  gameCategory.innerHTML = "";

  db.collection("categories").get().then(snap => {
    snap.forEach(doc => {
      const d = document.createElement("div");
      d.className = "item";
      d.innerHTML = `
        ${doc.data().name}
        <button onclick="deleteCategory('${doc.id}')">X</button>
      `;
      list.appendChild(d);

      const opt = document.createElement("option");
      opt.value = doc.id;
      opt.textContent = doc.data().name;
      gameCategory.appendChild(opt);
    });
  });
}

function loadGames() {
  const list = document.getElementById("gameList");
  list.innerHTML = "";

  db.collection("games").get().then(snap => {
    snap.forEach(doc => {
      const d = document.createElement("div");
      d.className = "item";
      d.innerHTML = `
        ${doc.data().title}
        <button onclick="deleteGame('${doc.id}')">X</button>
      `;
      list.appendChild(d);
    });
  });
}

function deleteCategory(id) {
  db.collection("categories").doc(id).delete();
  loadCategories();
}

function deleteGame(id) {
  db.collection("games").doc(id).delete();
  loadGames();
}

loadCategories();
loadGames();
</script>
</body>
</html>
