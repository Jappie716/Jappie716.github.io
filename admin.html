<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Game Paradise â€“ Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root {
  --bg: #020617;
  --card-bg: rgba(30, 41, 59, 0.4);
  --primary: #2563eb;
  --accent: #60a5fa;
  --danger: #ef4444;
  --success: #22c55e;
}

* { box-sizing: border-box; }
body {
  margin: 0; font-family: 'Segoe UI', system-ui, sans-serif;
  background: #020617; color: white;
  display: flex; height: 100vh; overflow: hidden;
}

/* SIDEBAR */
.sidebar {
  width: 260px; min-width: 260px; background: #010409;
  padding: 20px; display: flex; flex-direction: column; border-right: 1px solid #1e293b;
}
.logo { font-weight: bold; font-size: 20px; color: var(--accent); margin-bottom: 30px; text-align: center; }

.nav-btn {
  background: transparent; padding: 12px; border-radius: 10px;
  margin-bottom: 8px; cursor: pointer; border: none; color: #94a3b8;
  text-align: left; transition: 0.2s; display: flex; align-items: center; gap: 10px;
}
.nav-btn:hover { background: #1e293b; color: white; }
.nav-btn.active { background: var(--primary); color: white; font-weight: bold; }

/* MAIN CONTENT */
.main { flex: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #0f172a, #020617); }
.section { display: none; animation: fadeIn 0.4s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.card {
  background: var(--card-bg); backdrop-filter: blur(10px);
  padding: 25px; border-radius: 15px; border: 1px solid #1e293b;
  margin-bottom: 25px;
}

/* DASHBOARD SPECIFIEK */
.status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
.online { background: var(--success); box-shadow: 0 0 10px var(--success); }

/* LOGBOEK */
.log-container {
  background: #000; border-radius: 10px; padding: 15px;
  height: 250px; overflow-y: auto; font-family: 'Courier New', monospace;
  font-size: 13px; border: 1px solid #334155; color: #cbd5e1;
}

/* TOAST MELDINGEN */
#toast-container {
  position: fixed; top: 20px; right: 20px; z-index: 9999;
}
.toast {
  background: #1e293b; color: white; padding: 15px 25px; border-radius: 10px;
  margin-bottom: 10px; border-left: 5px solid var(--primary);
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  animation: slideIn 0.3s ease forwards;
}
@keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

/* EDITOR PREVIEW */
.editor-layout { display: grid; grid-template-columns: 1fr 320px; gap: 30px; }
.preview-pane { display: flex; flex-direction: column; align-items: center; border-left: 1px solid #1e293b; padding-left: 30px; }
.game-preview-card {
  width: 200px; background: #020617; border-radius: 12px;
  overflow: hidden; border: 1px solid #334155;
}
.game-preview-card img { width: 100%; height: 120px; object-fit: cover; background: #0f172a; }
.game-preview-card h4 { margin: 0; padding: 12px; text-align: center; font-size: 14px; }

input, select {
  width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 10px;
  border: 1px solid #334155; background: #0f172a; color: white; outline: none;
}
.btn { padding: 12px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
.success { background: var(--success); color: white; }
.danger { background: var(--danger); color: white; }
.warning { background: var(--warning); color: white; }

table { width: 100%; border-collapse: collapse; }
td, th { padding: 12px; border-bottom: 1px solid #1e293b; text-align: left; }
.thumb { width: 45px; height: 45px; border-radius: 6px; object-fit: cover; }
</style>
</head>
<body>

<div id="toast-container"></div>

<div class="sidebar">
  <div class="logo">ğŸ® Admin Panel</div>
  <button class="nav-btn active" id="tab-dashboard" onclick="showTab('dashboard')">ğŸ“Š Dashboard</button>
  <button class="nav-btn" id="tab-editor" onclick="showTab('editor')">âœï¸ Game Editor</button>
  <button class="nav-btn" id="tab-games" onclick="showTab('games')">ğŸ® Game Lijst</button>
  <button class="nav-btn" id="tab-categories" onclick="showTab('categories')">ğŸ“‚ CategorieÃ«n</button>
  
  <div style="margin-top: auto;">
   <button 
  class="btn" 
  style="width:100%; background:#1e293b; color:white; margin-bottom:10px"
  onclick="location.href='index.html'">
  ğŸŒ Bekijk Site
</button>

    <button class="btn danger" style="width:100%" onclick="logout()">ğŸšª Log uit</button>
  </div>
</div>

<div class="main">
  <div id="dashboardSection" class="section" style="display:block">
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
      <div class="card" style="margin-bottom:0">
        <h3 style="margin-top:0">ğŸ›°ï¸ Database Status</h3>
        <p><span class="status-dot online"></span> Verbonden met Firebase</p>
        <hr style="border:0; border-top:1px solid #1e293b; margin:15px 0">
        <p>Aantal Games: <b id="statGames">0</b></p>
        <p>Aantal CategorieÃ«n: <b id="statCategories">0</b></p>
      </div>
      <div class="card" style="margin-bottom:0">
        <h3 style="margin-top:0">ğŸ†• Laatste Update</h3>
        <p id="lastUpdateInfo" style="color:#94a3b8">Geen recente wijzigingen gevonden.</p>
      </div>
    </div>

    <div class="card">
      <h3>ğŸ“œ Systeem Logboek</h3>
      <div class="log-container" id="systemLog">
        <div style="color:var(--success)">[OK] Sessie gestart...</div>
      </div>
    </div>
  </div>

  <div id="editorSection" class="section">
    <div class="card">
      <div class="editor-layout">
        <div class="form-side">
          <h3 id="editorTitle">Game Toevoegen</h3>
          <input id="editId" placeholder="Game ID (bijv: super-cars)">
          <input id="editTitle" placeholder="Naam van de game" oninput="updatePreview()">
          <input id="editImg" placeholder="Afbeelding URL" oninput="updatePreview()">
          <input id="editLink" value="games/" oninput="updatePreview()">
          <select id="editCat"></select>
          <button class="btn success" style="width:100%" onclick="saveGame()">ğŸ’¾ Game Opslaan</button>
        </div>
        <div class="preview-pane">
          <p style="color:#64748b; font-size:11px; margin-bottom:10px">PREVIEW</p>
          <div class="game-preview-card">
            <img id="preImg" src="https://via.placeholder.com/200x120?text=Geen+Foto">
            <h4 id="preTitle">Titel</h4>
          </div>
          <button class="btn" style="margin-top:20px; background:#1e293b; color:white" onclick="resetEditor()">ğŸ§¹ Reset</button>
        </div>
      </div>
    </div>
  </div>

  <div id="gamesSection" class="section">
    <div class="card">
      <h3>Gepubliceerde Games</h3>
      <table>
        <thead><tr><th>Beeld</th><th>Titel</th><th>Categorie</th><th>Acties</th></tr></thead>
        <tbody id="gamesList"></tbody>
      </table>
    </div>
  </div>

  <div id="categoriesSection" class="section">
    <div class="card">
      <h3>Nieuwe Categorie</h3>
      <input id="catId" placeholder="ID (bijv: actie)">
      <input id="catName" placeholder="Naam (bijv: Actie Spellen)">
      <button class="btn success" onclick="addCategory()">Toevoegen</button>
    </div>
    <div class="card" id="categoriesList"></div>
  </div>
</div>

<script>
// --- CONFIG ---
const firebaseConfig = {
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490",
  storageBucket: "gameparadise-80490.firebasestorage.app",
  messagingSenderId: "335620903527",
  appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

// --- UI FUNCTIES ---
function notify(msg, type = 'success') {
  const container = document.getElementById('toast-container');
  const t = document.createElement('div');
  t.className = 'toast';
  t.style.borderLeftColor = type === 'success' ? 'var(--success)' : 'var(--danger)';
  t.innerText = msg;
  container.appendChild(t);
  setTimeout(() => t.remove(), 3000);
  addLog(msg, type);
}

function addLog(msg, type = 'info') {
  const log = document.getElementById('systemLog');
  const tijd = new Date().toLocaleTimeString();
  log.innerHTML = `<div style="margin-bottom:5px">[${tijd}] ${msg}</div>` + log.innerHTML;
}

function showTab(id) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id + 'Section').style.display = 'block';
  document.getElementById('tab-' + id).classList.add('active');
}

// --- DATA ---
auth.onAuthStateChanged(user => {
  if (user && user.email === "someoeneheilig@gmail.com") init();
  else location.href = "index.html";
});

function init() {
  db.collection("games").get().then(s => {
    document.getElementById('statGames').textContent = s.size;
    const list = document.getElementById('gamesList');
    list.innerHTML = "";
    s.forEach(doc => {
      const g = doc.data();
      list.innerHTML += `<tr>
        <td><img src="${g.image}" class="thumb"></td>
        <td><b>${g.title}</b><br><small>${doc.id}</small></td>
        <td>${g.category}</td>
        <td>
          <button class="btn warning" style="padding:5px 8px" onclick="editGame('${doc.id}')">âœï¸</button>
          <button class="btn danger" style="padding:5px 8px" onclick="deleteItem('games','${doc.id}')">ğŸ—‘ï¸</button>
        </td>
      </tr>`;
    });
  });

  db.collection("categories").get().then(s => {
    document.getElementById('statCategories').textContent = s.size;
    const list = document.getElementById('categoriesList');
    const select = document.getElementById('editCat');
    list.innerHTML = ""; select.innerHTML = "";
    s.forEach(doc => {
      list.innerHTML += `<div style="display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #1e293b">
        <span>${doc.data().name}</span>
        <button class="btn danger" style="padding:2px 8px" onclick="deleteItem('categories','${doc.id}')">X</button>
      </div>`;
      select.innerHTML += `<option value="${doc.id}">${doc.data().name}</option>`;
    });
  });
}

function updatePreview() {
  document.getElementById('preImg').src = document.getElementById('editImg').value || 'https://via.placeholder.com/200x120?text=Geen+Foto';
  document.getElementById('preTitle').textContent = document.getElementById('editTitle').value || "Titel";
}

function saveGame() {
  const id = document.getElementById('editId').value;
  const data = {
    title: document.getElementById('editTitle').value,
    image: document.getElementById('editImg').value,
    link: document.getElementById('editLink').value,
    category: document.getElementById('editCat').value
  };
  if(!id) return notify("ID verplicht!", "danger");
  db.collection("games").doc(id).set(data).then(() => {
    notify(`Game '${data.title}' succesvol opgeslagen!`);
    document.getElementById('lastUpdateInfo').innerText = `Laatst toegevoegd: ${data.title}`;
    resetEditor();
    init();
  });
}

function editGame(id) {
  db.collection("games").doc(id).get().then(doc => {
    const g = doc.data();
    document.getElementById('editId').value = id;
    document.getElementById('editId').disabled = true;
    document.getElementById('editTitle').value = g.title;
    document.getElementById('editImg').value = g.image;
    document.getElementById('editLink').value = g.link;
    document.getElementById('editCat').value = g.category;
    document.getElementById('editorTitle').textContent = "Bewerken: " + g.title;
    updatePreview();
    showTab('editor');
  });
}

function resetEditor() {
  document.getElementById('editId').value = "";
  document.getElementById('editId').disabled = false;
  document.getElementById('editTitle').value = "";
  document.getElementById('editImg').value = "";
  document.getElementById('editLink').value = "games/";
  updatePreview();
}

function addCategory() {
  const id = document.getElementById('catId').value;
  const name = document.getElementById('catName').value;
  db.collection("categories").doc(id).set({name}).then(() => {
    notify(`Categorie '${name}' toegevoegd!`);
    init();
  });
}

function deleteItem(col, id) {
  if(confirm("Zeker weten?")) {
    db.collection(col).doc(id).delete().then(() => {
      notify(`${id} verwijderd uit ${col}`, 'danger');
      init();
    });
  }
}

function logout() { auth.signOut().then(() => location.href="index.html"); }
</script>
</body>
</html>
