<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Game Paradise ‚Äì Admin Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root {
  --bg: #020617;
  --card-bg: rgba(30, 41, 59, 0.4);
  --primary: #2563eb;
  --accent: #60a5fa;
  --danger: #dc2626;
  --success: #16a34a;
  --warning: #f59e0b;
}

* { box-sizing: border-box; }
body {
  margin: 0; font-family: system-ui, sans-serif;
  background: #020617; color: white;
  display: flex; height: 100vh; overflow: hidden;
}

/* SIDEBAR */
.sidebar {
  width: 260px; min-width: 260px; background: #010409;
  padding: 20px; display: flex; flex-direction: column; border-right: 1px solid #1e293b;
}
.logo { text-align: center; font-weight: bold; font-size: 20px; color: var(--accent); margin-bottom: 30px; }

.nav-btn {
  background: transparent; padding: 12px; border-radius: 10px;
  margin-bottom: 8px; cursor: pointer; border: none; color: #94a3b8;
  text-align: left; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-size: 15px;
}
.nav-btn:hover { background: #1e293b; color: white; }
.nav-btn.active { background: var(--primary); color: white; font-weight: bold; }

/* MAIN CONTENT */
.main { flex: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #0f172a, #020617); }
.section { display: none; animation: fadeIn 0.4s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.card {
  background: var(--card-bg); backdrop-filter: blur(10px);
  padding: 25px; border-radius: 15px; border: 1px solid #1e293b;
  margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
}

/* LOGS & TERMINAL */
.log-container {
  background: #000; border-radius: 10px; padding: 15px;
  height: 200px; overflow-y: auto; font-family: 'Courier New', monospace;
  font-size: 12px; border: 1px solid #334155;
}
.log-entry { margin-bottom: 5px; border-left: 2px solid var(--primary); padding-left: 8px; }

/* EDITOR LAYOUT */
.editor-layout { display: grid; grid-template-columns: 1fr 320px; gap: 30px; }
.preview-pane { display: flex; flex-direction: column; align-items: center; border-left: 1px solid #1e293b; padding-left: 30px; }
.game-preview-card {
  width: 200px; background: #020617; border-radius: 12px;
  overflow: hidden; border: 1px solid #334155;
}
.game-preview-card img { width: 100%; height: 120px; object-fit: cover; background: #0f172a; }
.game-preview-card h4 { margin: 0; padding: 12px; text-align: center; font-size: 14px; }

/* UI ELEMENTS */
input, select {
  width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 10px;
  border: 1px solid #334155; background: #0f172a; color: white; outline: none;
}
.btn { padding: 12px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
.success { background: var(--success); color: white; }
.danger { background: var(--danger); color: white; }
.warning { background: var(--warning); color: white; }

table { width: 100%; border-collapse: collapse; }
td, th { padding: 12px; border-bottom: 1px solid #1e293b; text-align: left; }
.thumb { width: 45px; height: 45px; border-radius: 6px; object-fit: cover; }
</style>
</head>
<body>

<div class="sidebar">
  <div class="logo">üõ†Ô∏è Admin Console</div>
  <button class="nav-btn active" id="tab-dashboard" onclick="showTab('dashboard')">üìä Dashboard</button>
  <button class="nav-btn" id="tab-editor" onclick="showTab('editor')">‚úèÔ∏è Game Editor</button>
  <button class="nav-btn" id="tab-games" onclick="showTab('games')">üéÆ Game Lijst</button>
  <button class="nav-btn" id="tab-categories" onclick="showTab('categories')">üìÇ Categorie√´n</button>
  
  <div style="margin-top: auto; display: flex; flex-direction: column; gap: 10px;">
    <button class="btn" style="background:#1e293b; color:white;" onclick="window.open('index.html', '_blank')">üåê Bekijk Site</button>
    <button class="btn danger" onclick="logout()">üö™ Log uit</button>
  </div>
</div>

<div class="main">
  <div id="dashboardSection" class="section" style="display:block">
    <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 id="statGames">0</h2><p style="color:#94a3b8; margin:0">Games</p>
      </div>
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 style="color:var(--success)">124</h2><p style="color:#94a3b8; margin:0">Gebruikers Vandaag</p>
      </div>
      <div class="stat-box" style="background:var(--card-bg); padding:20px; border-radius:15px; text-align:center; border:1px solid #1e293b;">
        <h2 id="statCategories">0</h2><p style="color:#94a3b8; margin:0">Categorie√´n</p>
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 300px; gap: 25px;">
      <div class="card">
        <h3>üìú Systeem Logboek</h3>
        <div class="log-container" id="systemLog">
          <div class="log-entry" style="color:var(--success)">[Systeem] Console opgestart...</div>
        </div>
      </div>
      <div class="card">
        <h3>‚ö° Snelle Acties</h3>
        <button class="btn" style="width:100%; background:#1e293b; color:white; margin-bottom:10px" onclick="init()">üîÑ Data Verversen</button>
        <button class="btn" style="width:100%; background:#1e293b; color:white; margin-bottom:10px" onclick="addLog('Database backup gemaakt', 'warning')">üíæ Backup Maken</button>
        <button class="btn" style="width:100%; background:#1e293b; color:white" onclick="alert('Geen updates beschikbaar.')">üì¶ Systeem Update</button>
      </div>
    </div>
  </div>

  <div id="editorSection" class="section">
    <div class="card">
      <div class="editor-layout">
        <div class="form-side">
          <h3 id="editorTitle">Nieuwe Game Toevoegen</h3>
          <label style="color:#94a3b8; font-size:12px">Game ID</label>
          <input id="editId" placeholder="bijv: drive-mad">
          <label style="color:#94a3b8; font-size:12px">Titel</label>
          <input id="editTitle" placeholder="Naam van de game" oninput="updatePreview()">
          <label style="color:#94a3b8; font-size:12px">Afbeelding URL</label>
          <input id="editImg" placeholder="https://..." oninput="updatePreview()">
          <label style="color:#94a3b8; font-size:12px">Link (Bestandsnaam)</label>
          <input id="editLink" value="games/" oninput="updatePreview()">
          <label style="color:#94a3b8; font-size:12px">Categorie</label>
          <select id="editCat"></select>
          <button class="btn success" style="width:100%" onclick="saveGame()">üíæ Wijzigingen Opslaan</button>
        </div>
        <div class="preview-pane">
          <p style="color:#64748b; font-size:11px; margin-bottom:10px">LIVE PREVIEW</p>
          <div class="game-preview-card">
            <img id="preImg" src="https://via.placeholder.com/200x120?text=Geen+Foto">
            <h4 id="preTitle">Titel</h4>
          </div>
          <button class="btn" style="margin-top:20px; background:#1e293b; color:white" onclick="resetEditor()">üßπ Reset Formulier</button>
        </div>
      </div>
    </div>
  </div>

  <div id="gamesSection" class="section">
    <div class="card">
      <h3>Beheer alle Games</h3>
      <table>
        <thead><tr><th>Beeld</th><th>Titel (ID)</th><th>Categorie</th><th>Acties</th></tr></thead>
        <tbody id="gamesList"></tbody>
      </table>
    </div>
  </div>

  <div id="categoriesSection" class="section">
    <div class="card">
      <h3>Nieuwe Categorie</h3>
      <input id="catId" placeholder="ID (bijv: race)">
      <input id="catName" placeholder="Naam (bijv: Race Games)">
      <button class="btn success" onclick="addCategory()">Voeg Toe</button>
    </div>
    <div class="card" id="categoriesList"></div>
  </div>
</div>

<script>
// --- FIREBASE SETUP ---
const firebaseConfig = {
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490",
  storageBucket: "gameparadise-80490.firebasestorage.app",
  messagingSenderId: "335620903527",
  appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
const ADMIN_EMAIL = "someoeneheilig@gmail.com";

// --- NAVIGATIE ---
function showTab(id) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id + 'Section').style.display = 'block';
  document.getElementById('tab-' + id).classList.add('active');
  addLog(`Tab gewisseld naar: ${id}`);
}

// --- LOGBOEK FUNCTIE ---
function addLog(msg, type = 'info') {
  const log = document.getElementById('systemLog');
  const tijd = new Date().toLocaleTimeString();
  let kleur = '#94a3b8';
  if (type === 'success') kleur = '#16a34a';
  if (type === 'warning') kleur = '#f59e0b';
  if (type === 'danger') kleur = '#dc2626';
  
  log.innerHTML = `<div class="log-entry" style="border-color:${kleur}">[${tijd}] ${msg}</div>` + log.innerHTML;
}

// --- INITIALISATIE ---
auth.onAuthStateChanged(user => {
  if (user && user.email === ADMIN_EMAIL) {
    addLog(`Ingelogd als ${user.email}`, 'success');
    init();
  } else {
    location.href = "index.html";
  }
});

function init() {
  loadStats();
  loadGames();
  loadCats();
  addLog("Database gegevens ververst");
}

function loadStats() {
  db.collection("games").get().then(s => document.getElementById('statGames').textContent = s.size);
  db.collection("categories").get().then(s => document.getElementById('statCategories').textContent = s.size);
}

function loadGames() {
  const list = document.getElementById('gamesList');
  list.innerHTML = "";
  db.collection("games").get().then(snap => {
    snap.forEach(doc => {
      const g = doc.data();
      list.innerHTML += `<tr>
        <td><img src="${g.image}" class="thumb"></td>
        <td><b>${g.title}</b><br><small>${doc.id}</small></td>
        <td>${g.category}</td>
        <td>
          <button class="btn warning" style="padding:5px 8px" onclick="editGame('${doc.id}')">‚úèÔ∏è</button>
          <button class="btn danger" style="padding:5px 8px" onclick="deleteItem('games','${doc.id}')">üóëÔ∏è</button>
        </td>
      </tr>`;
    });
  });
}

function loadCats() {
  const list = document.getElementById('categoriesList');
  const select = document.getElementById('editCat');
  list.innerHTML = ""; select.innerHTML = "";
  db.collection("categories").get().then(snap => {
    snap.forEach(doc => {
      list.innerHTML += `<div style="display:flex; justify-content:space-between; padding:12px; border-bottom:1px solid #1e293b">
        <span>${doc.data().name} (${doc.id})</span>
        <button class="btn danger" style="padding:4px 10px" onclick="deleteItem('categories','${doc.id}')">Verwijder</button>
      </div>`;
      select.innerHTML += `<option value="${doc.id}">${doc.data().name}</option>`;
    });
  });
}

// --- EDITOR ACTIONS ---
function updatePreview() {
  document.getElementById('preImg').src = document.getElementById('editImg').value || 'https://via.placeholder.com/200x120?text=Geen+Foto';
  document.getElementById('preTitle').textContent = document.getElementById('editTitle').value || "Titel";
}

function resetEditor() {
  document.getElementById('editId').value = "";
  document.getElementById('editId').disabled = false;
  document.getElementById('editTitle').value = "";
  document.getElementById('editImg').value = "";
  document.getElementById('editLink').value = "games/";
  document.getElementById('editorTitle').textContent = "Nieuwe Game Toevoegen";
  updatePreview();
}

function editGame(id) {
  db.collection("games").doc(id).get().then(doc => {
    const g = doc.data();
    document.getElementById('editId').value = id;
    document.getElementById('editId').disabled = true;
    document.getElementById('editTitle').value = g.title;
    document.getElementById('editImg').value = g.image;
    document.getElementById('editLink').value = g.link;
    document.getElementById('editCat').value = g.category;
    document.getElementById('editorTitle').textContent = "Game Bewerken: " + g.title;
    updatePreview();
    showTab('editor');
  });
}

function saveGame() {
  const id = document.getElementById('editId').value.trim();
  const data = {
    title: document.getElementById('editTitle').value.trim(),
    image: document.getElementById('editImg').value.trim(),
    link: document.getElementById('editLink').value.trim(),
    category: document.getElementById('editCat').value
  };
  if(!id || !data.title) return addLog("Fout: ID en Titel verplicht", "danger");
  
  db.collection("games").doc(id).set(data).then(() => {
    addLog(`Game '${data.title}' opgeslagen!`, 'success');
    resetEditor();
    init();
  });
}

function addCategory() {
  const id = document.getElementById('catId').value.trim();
  const name = document.getElementById('catName').value.trim();
  if(!id || !name) return;
  db.collection("categories").doc(id).set({ name }).then(() => {
    addLog(`Categorie '${name}' toegevoegd`, 'success');
    init();
  });
}

function deleteItem(col, id) {
  if (confirm(`Zeker weten dat je '${id}' wilt verwijderen uit ${col}?`)) {
    db.collection(col).doc(id).delete().then(() => {
      addLog(`Item '${id}' verwijderd uit ${col}`, 'danger');
      init();
    });
  }
}

function logout() { auth.signOut().then(() => location.href = "index.html"); }
</script>
</body>
</html>
