<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>Game Paradise - home</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(180deg, #020617, #0b0f19);
  color: white;
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* --- TOAST MELDINGEN --- */
#toast-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 99999;
}

.toast {
  background: #1e293b;
  color: white;
  padding: 12px 20px;
  border-radius: 10px;
  margin-bottom: 10px;
  border-left: 5px solid #2563eb;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  animation: slideIn 0.3s ease forwards;
  font-size: 14px;
  min-width: 220px;
  display: flex;
  align-items: center;
  gap: 10px;
}

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

/* SIDEBAR */
.sidebar {
  width: 240px;
  min-width: 240px;
  background: #020617;
  padding: 15px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid #1e293b;
}

.logo {
  text-align: center; font-size: 22px; font-weight: bold;
  color: #60a5fa; margin-bottom: 15px;
}

.search-box input {
  width: 100%; padding: 8px; border-radius: 8px; border: none;
  background: #1e293b; color: white; margin-bottom: 15px;
}

/* CATEGORIES */
.category-btn {
  background: #020617; padding: 10px; border-radius: 8px;
  margin-bottom: 6px; cursor: pointer; transition: background 0.2s;
}
.category-btn:hover { background: #1e293b; }
.category-btn.active { background: #2563eb; }

/* MAIN */
.main { flex: 1; padding: 20px; overflow-y: auto; }
.topbar { display: flex; justify-content: space-between; align-items: center; }
.auth-btn {
  background: #2563eb; border: none; padding: 8px 14px;
  border-radius: 8px; color: white; cursor: pointer; margin-left: 6px;
}

.section-title { color: #60a5fa; margin: 15px 0; }
.loader { display: none; text-align: center; margin-top: 40px; color: #60a5fa; font-size: 18px; }

/* GAMES GRID */
.game-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 15px;
}

.game-card {
  background: #020617; border-radius: 12px; overflow: hidden;
  position: relative; transition: transform .2s, box-shadow .2s;
  box-shadow: 0 10px 20px rgba(0,0,0,.3);
}
.game-card:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 20px 40px rgba(0,0,0,.5); }
.game-card img { width: 100%; height: 110px; object-fit: cover; }
.game-card h3 { margin: 0; padding: 8px; text-align: center; font-size: 14px; }

.star { position: absolute; top: 8px; right: 10px; cursor: pointer; font-size: 20px; color: #444; z-index: 3; transition: transform 0.2s; }
.star:hover { transform: scale(1.2); }
.star.fav { color: gold; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }

.play-overlay {
  position: absolute; inset: 0; background: rgba(0,0,0,0.6);
  display: flex; justify-content: center; align-items: center;
  opacity: 0; transition: opacity .2s; pointer-events: none;
}
.game-card:hover .play-overlay { opacity: 1; }
.play-overlay span { background: #2563eb; padding: 8px 20px; border-radius: 20px; font-weight: bold; }

/* LOGIN MODAL */
.modal {
  position: fixed; inset: 0; background: rgba(0,0,0,0.8);
  display: none; justify-content: center; align-items: center; z-index: 10000;
}
.modal-box { background: #0f172a; padding: 25px; border-radius: 12px; width: 320px; text-align: center; border: 1px solid #1e293b; }
.modal-box input, .modal-box button { width: 100%; margin-top: 10px; padding: 10px; border-radius: 8px; border: none; }
.modal-box input { background: #1e293b; color: white; }
.modal-box button { background: #2563eb; color: white; cursor: pointer; font-weight: bold; }

.empty-state { 
  grid-column: 1 / -1; 
  text-align: center; 
  padding: 80px 20px; 
  color: #94a3b8; 
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.empty-state h3 { font-size: 24px; color: #60a5fa; margin-bottom: 10px; }
.empty-state p { font-size: 16px; max-width: 500px; line-height: 1.6; margin-bottom: 25px; }
.empty-state .btn-row { display: flex; gap: 10px; }
.secondary-btn { background: #1e293b; border: none; padding: 10px 18px; border-radius: 8px; color: white; cursor: pointer; }
</style>
</head>
<body>

<div id="toast-container"></div>

<div class="sidebar">
  <div class="logo">üéÆ Game Paradise</div>

  <div class="search-box">
    <input 
      id="searchInput" 
      type="text" 
      placeholder="Zoek games..." 
      autocomplete="new-password"
      onfocus="this.removeAttribute('readonly');" 
      readonly
    >
  </div>

  <div class="category-btn active" data-cat="all">Alle games</div>
  <div class="category-btn" data-cat="favorites">‚≠ê Favorieten</div>
  <div id="categoryList"></div>
</div>

<div class="main">
  <div class="topbar">
    <h2 id="sectionTitle" class="section-title">Alle games</h2>
    <div>
      <button id="adminBtn" class="auth-btn" style="display:none" onclick="location.href='admin.html'">Admin</button>
      <button id="authBtn" class="auth-btn">Inloggen</button>
    </div>
  </div>

  <div id="loader" class="loader">‚è≥ Games laden...</div>
  <div id="gameGrid" class="game-grid"></div>
</div>

<div id="loginModal" class="modal">
  <div class="modal-box">
    <h2 id="modalTitle">Inloggen</h2>
    <p id="modalSub" style="font-size: 13px; color: #94a3b8; display: none;">Log in om je favorieten op te slaan!</p>
    <input id="emailInput" type="email" placeholder="E-mail">
    <input id="passwordInput" type="password" placeholder="Wachtwoord">
    <button id="loginSubmit">Inloggen</button>
    <button id="registerSubmit" style="background:#16a34a;">Account maken</button>
    <button onclick="document.getElementById('loginModal').style.display='none'" style="background:transparent; color: #64748b; font-size: 12px;">Annuleren</button>
  </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA0K4geAuueVfiItB_98-LkqRTnpYNUNvM",
  authDomain: "gameparadise-80490.firebaseapp.com",
  projectId: "gameparadise-80490",
  storageBucket: "gameparadise-80490.firebasestorage.app",
  messagingSenderId: "335620903527",
  appId: "1:335620903527:web:1bc1e01a386bf6e4e7fac2"
};

if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const ADMIN_EMAIL = "someoeneheilig@gmail.com";
const authBtn = document.getElementById("authBtn");
const adminBtn = document.getElementById("adminBtn");
const modal = document.getElementById("loginModal");
const gameGrid = document.getElementById("gameGrid");
const searchInput = document.getElementById("searchInput");

let currentUser = null;
let favorites = {};
let allGames = {};
let currentFilter = "all";

/* --- NOTIFICATIE FUNCTIE --- */
function notify(msg, type = 'success') {
  const container = document.getElementById('toast-container');
  const t = document.createElement('div');
  t.className = 'toast';
  // Gebruik de kleuren van je admin paneel
  t.style.borderLeftColor = type === 'success' ? '#22c55e' : '#ef4444';
  
  // Voeg een icoontje toe voor de extra touch
  const icon = type === 'success' ? '‚úÖ' : 'üóëÔ∏è';
  t.innerHTML = `<span>${icon}</span> ${msg}`;
  
  container.appendChild(t);
  
  // Verwijder na 3 seconden met een kleine fade-out
  setTimeout(() => {
    t.style.opacity = '0';
    t.style.transform = 'translateX(20px)';
    t.style.transition = '0.3s';
    setTimeout(() => t.remove(), 300);
  }, 3000);
}

function showLogin(reason = false) {
    document.getElementById('modalSub').style.display = reason ? 'block' : 'none';
    modal.style.display = "flex";
}

function resetToAllGames() {
    const allBtn = document.querySelector(".category-btn[data-cat='all']");
    if (allBtn) allBtn.click();
}

/* AUTH LOGIC */
authBtn.onclick = () => currentUser ? auth.signOut() : showLogin();

document.getElementById("loginSubmit").onclick = () => {
    auth.signInWithEmailAndPassword(emailInput.value, passwordInput.value)
        .then(() => notify("Succesvol ingelogd!"))
        .catch(e => notify(e.message, 'danger'));
};

document.getElementById("registerSubmit").onclick = () => {
    auth.createUserWithEmailAndPassword(emailInput.value, passwordInput.value)
        .then(() => notify("Account aangemaakt! Veel plezier."))
        .catch(e => notify(e.message, 'danger'));
};

auth.onAuthStateChanged(user => {
  currentUser = user;
  favorites = {};
  if (user) {
    authBtn.textContent = "Uitloggen";
    modal.style.display = "none";
    adminBtn.style.display = user.email === ADMIN_EMAIL ? "inline-block" : "none";
    loadFavorites();
  } else {
    authBtn.textContent = "Inloggen";
    adminBtn.style.display = "none";
    renderGames();
  }
  loadCategories();
  loadGames();
});

/* FAVORITES LOGIC */
function loadFavorites() {
  if (!currentUser) return;
  db.collection("users").doc(currentUser.uid).collection("favorites").get().then(snap => {
      snap.forEach(doc => favorites[doc.id] = doc.data());
      renderGames();
  });
}

function toggleFavorite(id) {
  if (!currentUser) {
    showLogin(true);
    return;
  }
  const ref = db.collection("users").doc(currentUser.uid).collection("favorites").doc(id);
  const gameName = allGames[id].title;

  if (favorites[id]) {
    delete favorites[id];
    ref.delete();
    notify(`"${gameName}" verwijderd uit favorieten`, 'danger');
  } else {
    favorites[id] = allGames[id];
    ref.set(allGames[id]);
    notify(`"${gameName}" toegevoegd aan favorieten!`, 'success');
  }
  renderGames();
}

/* RENDERING */
function renderGames() {
  const search = searchInput.value.toLowerCase();
  gameGrid.innerHTML = "";

  if (currentFilter === "favorites" && !currentUser) {
      gameGrid.innerHTML = `
        <div class="empty-state">
            <h3>‚≠ê Favorieten</h3>
            <p>Wil je je favoriete games bewaren en altijd snel terugvinden? Log dan in of maak een account aan om je persoonlijke lijst te beheren.</p>
            <div class="btn-row">
                <button class="auth-btn" onclick="showLogin(true)">Nu Inloggen</button>
                <button class="secondary-btn" onclick="resetToAllGames()">Terug naar alle games</button>
            </div>
        </div>`;
      return;
  }

  let count = 0;
  Object.entries(allGames).forEach(([id, g]) => {
    const fav = favorites[id];
    if (currentFilter === "favorites" && !fav) return;
    if (currentFilter !== "all" && currentFilter !== "favorites" && g.category !== currentFilter) return;
    if (search && !g.title.toLowerCase().includes(search)) return;

    count++;
    const div = document.createElement("div");
    div.className = "game-card";
    div.innerHTML = `
      <div class="star ${fav ? 'fav' : ''}">‚òÖ</div>
      <img src="${g.image || ''}">
      <h3>${g.title || 'Laden...'}</h3>
      <div class="play-overlay"><span>‚ñ∂ Play</span></div>
    `;

    div.onclick = (e) => {
        if (e.target.classList.contains("star")) {
            toggleFavorite(id);
        } else {
            location.href = g.link;
        }
    };
    gameGrid.appendChild(div);
  });

  if (count === 0 && !document.querySelector('.empty-state')) {
      gameGrid.innerHTML = `<div class="empty-state"><p>Geen games gevonden...</p></div>`;
  }
}

function loadGames() {
  document.getElementById("loader").style.display = "block";
  db.collection("games").get().then(snap => {
    allGames = {};
    snap.forEach(doc => allGames[doc.id] = doc.data());
    document.getElementById("loader").style.display = "none";
    renderGames();
  });
}

function loadCategories() {
  const catList = document.getElementById("categoryList");
  const currentActiveId = currentFilter;
  catList.innerHTML = "";
  db.collection("categories").get().then(snap => {
    snap.forEach(doc => {
      const btn = document.createElement("div");
      btn.className = "category-btn" + (currentActiveId === doc.id ? " active" : "");
      btn.textContent = doc.data().name;
      btn.onclick = () => {
        document.querySelectorAll(".category-btn").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentFilter = doc.id;
        document.getElementById("sectionTitle").textContent = doc.data().name;
        renderGames();
      };
      catList.appendChild(btn);
    });
  });
}

document.querySelectorAll(".category-btn[data-cat]").forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll(".category-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    currentFilter = btn.dataset.cat;
    document.getElementById("sectionTitle").textContent = btn.textContent;
    renderGames();
  };
});

searchInput.oninput = () => renderGames();
window.onload = () => { 
    searchInput.value = ""; 
    renderGames();
};
</script>
</body>
</html>
